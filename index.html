<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova's Potty Training Adventure v2</title>
    <style>
        /* å¼•å…¥å¯æ„›çš„å­—é«” */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap');

        body {
            font-family: 'Fredoka One', cursive, sans-serif;
            background-color: #e6f7ff; /* æ›´æŸ”å’Œçš„èƒŒæ™¯è‰² */
            background-image: radial-gradient(#ffffff 20%, transparent 20%),
                              radial-gradient(#ffffff 20%, transparent 20%);
            background-size: 50px 50px;
            background-position: 0 0, 25px 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            overflow: hidden;
            text-align: center;
        }

        h1 { color: #ff69b4; margin: 0 0 15px 0; font-size: 28px; text-shadow: 2px 2px 0px #fff; }

        .game-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px 20px;
            border-radius: 30px;
            box-shadow: 0 15px 35px rgba(100,180,255,0.3);
            width: 100%;
            max-width: 420px;
            position: relative;
            border: 5px solid #fff;
        }

        /* é€²åº¦æ¢å€åŸŸ */
        .status-bars { margin-bottom: 20px; }
        .bar-container { margin: 12px 0; text-align: left; }
        .label { font-size: 16px; color: #555; margin-bottom: 8px; display: flex; justify-content: space-between; }
        .label span:last-child { font-size: 14px; color: #999; }

        .progress-track {
            background-color: #e0e0e0;
            border-radius: 15px;
            height: 22px;
            width: 100%;
            overflow: hidden;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
            border: 3px solid #fff;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.4s;
            border-radius: 15px;
            /* æ·»åŠ æ¢ç´‹æ•ˆæœ */
            background-image: linear-gradient(45deg, rgba(255,255,255,.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.15) 50%, rgba(255,255,255,.15) 75%, transparent 75%, transparent);
            background-size: 20px 20px;
        }

        #poop-bar { background-color: #8b4513; }
        #mood-bar { background-color: #4caf50; }

        /* è§’è‰²èˆå°å€ */
        .character-stage {
            height: 220px;
            display: flex;
            align-items: flex-end; /* è®“è§’è‰²ååœ¨é¦¬æ¡¶ä¸Š */
            justify-content: center;
            margin-bottom: 10px;
            position: relative;
        }

        /* Nova çš„åœ–ç‰‡å®¹å™¨ */
        .nova-avatar {
            position: relative;
            z-index: 2;
            transition: transform 0.2s;
            /* é è¨­å‘¼å¸å‹•ç•«ï¼Œè®“éœæ…‹åœ–çœ‹èµ·ä¾†æœ‰å‹•æ…‹æ„Ÿ */
            animation: breathe 3s ease-in-out infinite;
        }

        /* Nova çš„åœ–ç‰‡æœ¬é«” */
        .nova-avatar img {
            width: 160px; /* èª¿æ•´åœ–ç‰‡å¤§å° */
            height: auto;
            display: block;
            /* é‡è¦ï¼šç¢ºä¿åœ–ç‰‡å»èƒŒä¹¾æ·¨ */
        }

        /* é¦¬æ¡¶ */
        .toilet {
            position: absolute;
            bottom: 10px;
            font-size: 100px;
            z-index: 1;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.1));
        }

        /* æ‰ä¸‹ä¾†çš„ä¾¿ä¾¿ */
        .poop-drop {
            position: absolute;
            font-size: 50px;
            top: 50%;
            left: 50%;
            transform: translateX(-50%);
            z-index: 0;
            opacity: 0;
            transition: top 0.8s cubic-bezier(0.5, 0.05, 0.1, 0.3), opacity 0.5s;
        }
        .poop-drop.falling { opacity: 1; top: 110%; }

        /* ç‹€æ…‹è¨Šæ¯ */
        #message {
            min-height: 30px;
            margin: 5px 0 15px 0;
            color: #FF9800;
            font-weight: bold;
            font-size: 18px;
        }

        /* æŒ‰éˆ•å€åŸŸ */
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
        }

        button {
            border: none;
            border-radius: 20px;
            padding: 15px 5px;
            font-size: 16px;
            font-family: 'Fredoka One', cursive, sans-serif;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 6px 0 rgba(0,0,0,0.1);
            position: relative;
            top: 0;
        }

        button:active { top: 6px; box-shadow: 0 0 0 rgba(0,0,0,0.1); }
        button:disabled { opacity: 0.6; cursor: not-allowed; filter: grayscale(80%); top: 6px; box-shadow: none; }

        .btn-push { background-color: #ff8a80; color: #fff; } /* ç´…è‰²ç³» */
        .btn-drink { background-color: #4fc3f7; color: #fff; } /* è—è‰²ç³» */
        .btn-sing { background-color: #ffd54f; color: #fff; } /* é»ƒè‰²ç³» */

        .icon { font-size: 28px; margin-bottom: 8px; }

        /* --- å‹•ç•«å®šç¾© --- */
        /* å‘¼å¸ */
        @keyframes breathe {
            0%, 100% { transform: scale(1) translateY(0); }
            50% { transform: scale(1.03) translateY(-3px); }
        }
        /* ç”¨åŠ›ç™¼æŠ– */
        .shake { animation: shake 0.5s infinite; }
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            20% { transform: translate(-2px, 0px) rotate(1deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            60% { transform: translate(-2px, 1px) rotate(0deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
        }
        /* é–‹å¿ƒè·³å‹• */
        .bounce { animation: bounce 0.6s infinite; }
        @keyframes bounce {
            0%, 100% {transform: translateY(0) scale(1);}
            50% {transform: translateY(-15px) scale(1.05);}
        }

        .reset-btn {
            width: 100%;
            margin-top: 25px;
            background: #90a4ae;
            color: white;
            padding: 12px;
            border-radius: 15px;
            border: none;
            font-family: inherit;
            font-size: 16px;
            cursor: pointer;
        }

    </style>
</head>
<body>

    <div class="game-container">
        <h1>âœ¨ Nova's Potty Time âœ¨</h1>

        <div class="status-bars">
            <div class="bar-container">
                <div class="label">
                    <span>ğŸ’© ä¾¿ä¾¿é€²åº¦ (Poop Progress)</span>
                    <span id="poop-val">0%</span>
                </div>
                <div class="progress-track">
                    <div class="progress-fill" id="poop-bar"></div>
                </div>
            </div>
            <div class="bar-container">
                <div class="label">
                    <span>ğŸ˜¡ ç…©èºæŒ‡æ•¸ (Bad Mood)</span>
                    <span id="mood-val">0%</span>
                </div>
                <div class="progress-track">
                    <div class="progress-fill" id="mood-bar"></div>
                </div>
            </div>
        </div>

        <div class="character-stage">
            <div class="poop-drop" id="poop-drop">ğŸ’©</div>
            <div class="toilet">ğŸš½</div>
            <div class="nova-avatar" id="nova-container">
                <img id="nova-img" src="https://via.placeholder.com/160x160/e6f7ff/ff69b4?text=Nova+Idle" alt="Nova Idle">
            </div>
        </div>

        <div id="message">æº–å‚™å¥½äº†å—ï¼Ÿ</div>

        <div class="controls" id="control-buttons">
            <button class="btn-push" onclick="actionPush()">
                <span class="icon">ğŸ˜£</span>
                PUSH (ç”¨åŠ›)
            </button>
            <button class="btn-drink" onclick="actionDrink()">
                <span class="icon">ğŸ¥¤</span>
                DRINK (å–æ°´)
            </button>
            <button class="btn-sing" onclick="actionSing()">
                <span class="icon">ğŸµ</span>
                SING (å”±æ­Œ)
            </button>
        </div>
        
        <button class="reset-btn" onclick="resetGame()" style="display:none;" id="reset-btn">å†ä¾†ä¸€æ¬¡ (Play Again)</button>
    </div>

    <script>
        /* Let's make it dynamic! */

        // éŠæˆ²ç‹€æ…‹
        let poopProgress = 0;
        let badMood = 0;
        let gameActive = true;
        let currentAnimClass = '';

        // DOM å…ƒç´ 
        const poopBar = document.getElementById('poop-bar');
        const moodBar = document.getElementById('mood-bar');
        const poopVal = document.getElementById('poop-val');
        const moodVal = document.getElementById('mood-val');
        const novaContainer = document.getElementById('nova-container');
        const novaImg = document.getElementById('nova-img');
        const message = document.getElementById('message');
        const poopDrop = document.getElementById('poop-drop');
        const controlButtons = document.getElementById('control-buttons');
        const resetBtn = document.getElementById('reset-btn');

        // === åœ–ç‰‡ä¾†æºè¨­å®š (è«‹æ›¿æ›é€™è£¡çš„é€£çµ) ===
        const novaImages = {
            // æ™®é€š/ç­‰å¾…ç‹€æ…‹åœ–ç‰‡
            idle: 'https://via.placeholder.com/160x160/e6f7ff/ff69b4?text=Nova+IdleğŸ‘§', 
            // ç”¨åŠ›ç‹€æ…‹åœ–ç‰‡
            push: 'https://via.placeholder.com/160x160/ffcccb/8b0000?text=Nova+PushğŸ˜£', 
            // é–‹å¿ƒ/å–æ°´/å”±æ­Œç‹€æ…‹åœ–ç‰‡
            happy: 'https://via.placeholder.com/160x160/fff9c4/f57f17?text=Nova+HappyğŸ˜‹', 
            // ç”Ÿæ°£/å¤±æ•—ç‹€æ…‹åœ–ç‰‡
            angry: 'https://via.placeholder.com/160x160/ff4d4d/ffffff?text=Nova+AngryğŸ˜¡',
            // æˆåŠŸç‹€æ…‹åœ–ç‰‡
            success: 'https://via.placeholder.com/160x160/e6f7ff/ff69b4?text=Nova+Yay!ğŸ¤©' 
        };

        // å·¥å…·å‡½æ•¸ï¼šç”¢ç”Ÿ min åˆ° max ä¹‹é–“çš„éš¨æ©Ÿæ•´æ•¸
        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // è¨­ç½®è§’è‰²ç‹€æ…‹ (åœ–ç‰‡èˆ‡å‹•ç•«é¡åˆ¥)
        function setNovaState(imgKey, animClass = '', msg = '') {
            novaImg.src = novaImages[imgKey];
            
            if (currentAnimClass) {
                novaContainer.classList.remove(currentAnimClass);
            }
            if (animClass) {
                novaContainer.classList.add(animClass);
                currentAnimClass = animClass;
            } else {
                currentAnimClass = '';
            }
            
            if(msg) message.innerText = msg;
        }

        // æ›´æ–°ä»‹é¢
        function updateUI() {
            // ç¢ºä¿æ•¸å€¼åœ¨ 0-100 ä¹‹é–“
            poopProgress = Math.min(100, Math.max(0, poopProgress));
            badMood = Math.min(100, Math.max(0, badMood));

            poopBar.style.width = poopProgress + '%';
            moodBar.style.width = badMood + '%';
            poopVal.innerText = poopProgress + '%';
            moodVal.innerText = badMood + '%';

            // ç…©èºæ¢é¡è‰²è®ŠåŒ–
            if (badMood < 50) { moodBar.style.backgroundColor = '#4caf50'; } 
            else if (badMood < 80) { moodBar.style.backgroundColor = '#ff9800'; } 
            else { moodBar.style.backgroundColor = '#d32f2f'; }
        }

        // æª¢æŸ¥éŠæˆ²çµæŸæ¢ä»¶
        function checkGameState() {
            if (!gameActive) return;

            if (poopProgress >= 100) {
                gameWin();
            } else if (badMood >= 100) {
                gameLose();
            } else {
                updateUI();
            }
        }

        // æš«æ™‚çš„ç‹€æ…‹æ•ˆæœ (å‹•ä½œå¾Œè‡ªå‹•æ¢å¾©æ™®é€šç‹€æ…‹)
        let resetTimer;
        function tempState(imgKey, animClass, msg) {
            clearTimeout(resetTimer); // æ¸…é™¤ä¹‹å‰çš„è¨ˆæ™‚å™¨
            setNovaState(imgKey, animClass, msg);
            
            // 1ç§’å¾Œæ¢å¾© Idle ç‹€æ…‹ï¼Œé™¤ééŠæˆ²çµæŸ
            resetTimer = setTimeout(() => {
                if (gameActive) {
                    setNovaState('idle', '', 'Nova åŠ æ²¹!');
                }
            }, 1000);
        }

        // --- å‹•ä½œæŒ‰éˆ• ---

        // 1. PUSH: å¤§å¹…å¢åŠ ä¾¿ä¾¿ï¼Œå¤§å¹…å¢åŠ ç…©èº (éš¨æ©Ÿ 8-15%)
        function actionPush() {
            if (!gameActive) return;
            let pGain = getRandomInt(8, 15);
            let mGain = getRandomInt(8, 15);
            poopProgress += pGain;
            badMood += mGain;
            tempState('push', 'shake', `æ©~~~~! (ä¾¿ä¾¿+${pGain}%, ç…©èº+${mGain}%)`);
            checkGameState();
        }

        // 2. DRINK: å°‘é‡å¢åŠ ä¾¿ä¾¿ (éš¨æ©Ÿ 3-8%)ï¼Œä¸­ç­‰é™ä½ç…©èº (éš¨æ©Ÿ 5-12%)
        function actionDrink() {
            if (!gameActive) return;
            let pGain = getRandomInt(3, 8);
            let mDrop = getRandomInt(5, 12);
            poopProgress += pGain;
            badMood -= mDrop;
            tempState('happy', 'bounce', `å’•åš•å’•åš•! (ä¾¿ä¾¿+${pGain}%, å¿ƒæƒ…è®Šå¥½)`);
            checkGameState();
        }

        // 3. SING: ä¸å¢åŠ ä¾¿ä¾¿ï¼Œå¤§å¹…é™ä½ç…©èº (éš¨æ©Ÿ 10-15%)
        function actionSing() {
            if (!gameActive) return;
            let mDrop = getRandomInt(10, 15);
            badMood -= mDrop;
            tempState('happy', 'bounce', `La La La~ (å¿ƒæƒ…æ”¾é¬†äº†!)`);
            checkGameState();
        }

        // --- éŠæˆ²çµæŸé‚è¼¯ ---
        function toggleControls(active) {
            const buttons = controlButtons.getElementsByTagName('button');
            for (let btn of buttons) { btn.disabled = !active; }
            resetBtn.style.display = active ? 'none' : 'block';
        }

        function gameWin() {
            gameActive = false;
            poopProgress = 100;
            updateUI();
            setNovaState('success', 'bounce', "å¤ªæ£’äº†ï¼æˆåŠŸäº†ï¼âœ¨");
            poopDrop.classList.add('falling');
            toggleControls(false);
        }

        function gameLose() {
            gameActive = false;
            badMood = 100;
            updateUI();
            setNovaState('angry', 'shake', "Nova ç”Ÿæ°£äº†ï¼Œä¸æƒ³ä¸Šäº†... ğŸ˜­");
            toggleControls(false);
        }

        function resetGame() {
            poopProgress = 0;
            badMood = 0;
            gameActive = true;
            setNovaState('idle', '', 'æº–å‚™å¥½äº†å—ï¼Ÿ');
            poopDrop.classList.remove('falling');
            toggleControls(true);
            updateUI();
        }

        // åˆå§‹åŒ–
        resetGame();

    </script>
</body>
</html>
